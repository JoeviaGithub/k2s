#!/usr/bin/env node


// Define global.navigator for borwser module.
global.navigator = {
	userAgent: ''
};


var JsSIP = require("../");


var j = new JsSIP.UA({
	display_name: "Pepe œæ€!!!",
	ws_servers: "ws://ws1.versatica.com:10080",
	// ws_servers: "ws://127.0.0.1:10080",
	// ws_servers: "ws://1.2.3.4",
	uri:"sip:qweqwe@tryit.jssip.net",
	register: true,
	node_websocket_options: {
		origin: "http://tryit.jssip.net",
		// host: "tryit.jssip.net",
		// origin: "http://gsickminds2014.demo"
	}
});


j.on('connected', function() {
	console.log('>>> connected');
});

j.on('registered', function() {
	console.log('>>> registered');
});

j.on('disconnected', function(data) {
	console.log('>>> disconnected | data: %o', data);
});

j.on('unregistered', function(data) {
	console.log('>>> unregistered | data: %o', data);
});

j.on('newMessage', function(e) {
	if (e.data.originator === 'local')  return;

	console.log('>>> message from %s: %s', e.data.message.remote_identity, e.data.request.body);
});

j.start();




// Run interactive Node REPL.

global.JssIP = JsSIP;
global.j = j;  // Make the app global.
var r = require('repl').start({
	// prompt: '\n',
	useColors: true,
	useGlobal: true,
	ignoreUndefined: true
});
r.on('exit', function () {
	console.log();
	process.exit();
});
